# 加密新闻驱动自动交易系统 —— 产品开发详细说明书

## 一、项目概述

本项目旨在开发一个自动化的数字货币交易系统。该系统基于方程式新闻（Formula News）WebSocket实时捕捉币圈新闻，通过情感分析与关键词规则对新闻进行“利好/利空”判断，并自动对接币安交易所API实现买入/卖出及止损策略。产品支持实盘和测试盘切换，提供前端界面展示交易、新闻、持仓等信息。

---

## 二、功能模块

### 1. 新闻采集与处理

- **WebSocket实时采集**：接入方程式新闻WebSocket，实时接收最新币圈新闻。
- **新闻过滤**：支持根据平台、币种、关键字配置过滤，重点关注特定对象。
- **情感分析**：通过关键词规则与情感分析模型判断新闻为“利好”、“利空”或“中性”。
- **多语言兼容**：支持中英文新闻。

### 2. 自动交易执行

- **币安API对接**：支持币安现货API，兼容Testnet与Real环境。
- **自动买入/卖出**：根据新闻情绪自动买入或卖出指定币种。
- **止损机制**：买入后自动监控币价，按设定百分比自动止损卖出。
- **币种/数量配置**：支持自定义交易币对和单笔买入数量。

### 3. 前端展示与管理

- **持仓管理**：实时展示当前持仓、买入价、浮动盈亏等。
- **新闻流**：展示已处理/过滤的新闻及其情绪判定结果。
- **自动交易记录**：展示历史交易明细。
- **止损状态**：展示当前止损监控状态。
- **模式切换**：一键切换测试盘/实盘。

### 4. 配置与扩展

- **参数配置**：通过配置文件或前端界面，灵活调整关键词、平台、币种、止损比例等。
- **安全管理**：API密钥加密存储，重要操作多重确认。

---

## 三、技术架构与选型

### 1. 后端

- **语言**：Python
- **核心库**：
  - `python-binance`（币安API）
  - `websocket-client`（WebSocket）
  - `Flask`或`FastAPI`（REST API服务）
  - `Threading/Asyncio`（并发止损监控）
- **结构建议**：
  ```
  backend/
  ├── config.py            # 配置管理
  ├── main.py              # 主入口，WS监听
  ├── binance_client.py    # 币安API封装
  ├── news_handler.py      # 新闻处理与情绪判定
  ├── stop_loss.py         # 止损监控
  ├── api.py               # REST接口
  └── requirements.txt
  ```

### 2. 前端

- **技术选型**：React 或 Vue
- **主要页面**：
  - 新闻流
  - 持仓展示
  - 交易与止损记录
  - 配置与模式切换
- **接口对接**：通过REST API与后端通信

### 3. 数据存储（可选）

- **轻量级方案**：本地JSON/SQLite，记录交易与持仓
- **扩展方案**：可对接MongoDB/MySQL等

---

## 四、核心流程说明

1. **新闻流入**：WebSocket接收新闻，过滤并情感分析，提取币种与情绪。
2. **执行交易**：若为利好，买入币种，启动止损监控；若为利空且有持仓，卖出币种。
3. **止损监控**：买入后实时监控币价，触发止损条件即自动卖出。
4. **前端展示**：实时同步新闻、交易、持仓、止损状态。
5. **模式切换**：支持一键切换测试盘与实盘，API KEY独立管理。

---

## 五、算法与业务规则

### 1. 新闻情绪判定

- **关键词法**：维护正/负关键词列表，出现即判定情绪。
- **情感分析**：可接入NLP情感API或自有模型辅助判断。
- **优先级**：关键词优先，无法判断时为中性不操作。

### 2. 止损逻辑

- **参数**：如10%止损（默认可配）
- **方式**：买入后定时轮询现价，低于止损价自动卖出
- **线程/协程**：每笔持仓独立监控

### 3. 交易币种与数量

- **币种**：币安主流币种，支持配置
- **数量**：单笔定额或按账户余额比例配置

---

## 六、配置举例

```python
# config.py
TESTNET = True
API_KEY = "xxxx"
API_SECRET = "xxxx"
POSITIVE_KEYWORDS = ["回购", "合作", "上线", "奖励", "质押"]
NEGATIVE_KEYWORDS = ["被盗", "崩盘", "黑客", "破产", "停运"]
FOCUS_PLATFORMS = ["Binance", "Orca", "Solana"]
FOCUS_KEYWORDS = ["回购", "质押"]
STOP_LOSS_PCT = 0.1
TRADE_COINS = ["BTC", "ETH", "ORCA"]
TRADE_AMOUNT = {"BTC": 0.001, "ETH": 0.01, "ORCA": 10}
```

---

## 七、开发计划建议

1. **第一阶段**：后端核心逻辑开发
   - WebSocket接入与新闻处理
   - 币安API对接与模拟下单
   - 止损监控实现
2. **第二阶段**：前端开发与API联调
   - 新闻流与交易状态展示
   - 配置界面与模式切换
3. **第三阶段**：完善风控、异常处理、安全加固
   - API密钥加密
   - 错误恢复与报警
4. **第四阶段**：测试与部署
   - 测试盘全流程压力测试
   - 文档完善与上线部署

---

## 八、扩展与演进

- 多策略支持：如结合K线/指标与新闻共振操作
- 其他交易所接入
- 多账户协作与管理
- 更复杂的风控体系

---

## 九、风险提示及免责声明

- 新闻情绪自动判定存在误差，自动交易存在高度风险。
- 测试盘充分验证策略后方可启用实盘，投资需谨慎。

---

## 十、联系方式与后续支持

如需详细代码脚手架、模块化实现、环境部署或上线运维支持，可联系开发团队协作完成。

---